<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Mr.heesong@gmail.com Song "><meta name=description content="What is SSO? Single sign-on (SSO) is an authentication method that enables users to securely authenticate with multiple applications and websites by using just one set of credentials. How Does Single Sign-On (SSO) protocol Work? There are two commonly used SSO protocols namely SAML and OAuth2. OAuth2 Role OAuth defines four roles: resource owner An entity capable of granting access to a protected resource. When the resource owner is a"><meta name=keywords content="js,javascript,nodejs,jquery,css,sass,gulp,html,git,java,hibernate,spring,maven,mysql,sql,linux,acm,架构,前端,后端,原创,编程,开发,算法,运维,云计算,网络,互联网,笔记"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://blog.singasoong.top/posts/sso/><title>SSO 笔记 :: Song's Blog</title><link rel=stylesheet href=/main.b78c3be9451dc4ca61ca377f3dc2cf2e6345a44c2bae46216a322ef366daa399.css integrity="sha256-t4w76UUdxMphyjd/PcLPLmNFpEwrrkYhajIu82bao5k="><link rel=stylesheet type=text/css href=/css/main.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="SSO 笔记"><meta itemprop=description content="What is SSO? Single sign-on (SSO) is an authentication method that enables users to securely authenticate with multiple applications and websites by using just one set of credentials. How Does Single Sign-On (SSO) protocol Work? There are two commonly used SSO protocols namely SAML and OAuth2. OAuth2 Role OAuth defines four roles: resource owner An entity capable of granting access to a protected resource. When the resource owner is a"><meta itemprop=datePublished content="2023-09-20T15:58:07+08:00"><meta itemprop=dateModified content="2023-09-20T15:58:07+08:00"><meta itemprop=wordCount content="929"><meta itemprop=image content="https://blog.singasoong.top/"><meta itemprop=keywords content="笔记,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.singasoong.top/"><meta name=twitter:title content="SSO 笔记"><meta name=twitter:description content="What is SSO? Single sign-on (SSO) is an authentication method that enables users to securely authenticate with multiple applications and websites by using just one set of credentials. How Does Single Sign-On (SSO) protocol Work? There are two commonly used SSO protocols namely SAML and OAuth2. OAuth2 Role OAuth defines four roles: resource owner An entity capable of granting access to a protected resource. When the resource owner is a"><meta property="og:title" content="SSO 笔记"><meta property="og:description" content="What is SSO? Single sign-on (SSO) is an authentication method that enables users to securely authenticate with multiple applications and websites by using just one set of credentials. How Does Single Sign-On (SSO) protocol Work? There are two commonly used SSO protocols namely SAML and OAuth2. OAuth2 Role OAuth defines four roles: resource owner An entity capable of granting access to a protected resource. When the resource owner is a"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.singasoong.top/posts/sso/"><meta property="og:image" content="https://blog.singasoong.top/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-20T15:58:07+08:00"><meta property="article:modified_time" content="2023-09-20T15:58:07+08:00"><meta property="article:published_time" content="2023-09-20 15:58:07 +0800 +0800"><script async src="https://www.googletagmanager.com/gtag/js?id=G-3X06DFVWWN"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3X06DFVWWN")</script></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>peace & love</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://blog.singasoong.top/posts>Blog</a></li><li><a href=https://blog.singasoong.top/tags>Tag</a></li><li><a href=/search><svg t="1556783211810" class="search-box-icon" class="icon" style viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="2078" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style/></defs><path d="M981.39652054 920.86314525 704.56522859 644.0318533a366.65501012 366.65501012.0 10-61.73503038 65.64040943L917.55859375 984.40065827zM125.21726707 427.73393664a284.19142939 284.19142939.0 11283.89101562 284.19142939A284.49184317 284.49184317.0 01125.06706019 427.73393664z" fill p-id="2079" data-spm-anchor-id="a313x.7781069.0.i2"/></svg></a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><ol class=breadcrumb><li><a href=https://blog.singasoong.top/>Home</a></li><li><a href=https://blog.singasoong.top/posts/>Posts</a></li><li class=active><a href=https://blog.singasoong.top/posts/sso/>SSO 笔记</a></li></ol><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>2 minutes</p></div><article><h1 class=post-title><a href=https://blog.singasoong.top/posts/sso/>SSO 笔记</a></h1><hr><aside id=toc><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#what-is-sso>What is SSO?</a></li><li><a href=#how-does-single-sign-on-sso-protocol-work>How Does Single Sign-On (SSO) protocol Work?</a><ul><li><a href=#oauth2>OAuth2</a></li><li><a href=#saml-20>SAML 2.0</a></li></ul></li><li><a href=#usage-in-javaspring-security>Usage in Java(Spring Security)</a></li></ul></nav></aside><hr><div class=post-content><h2 id=what-is-sso>What is SSO?</h2><p>Single sign-on (SSO) is an authentication method that enables users to securely authenticate with multiple applications and websites by using just one set of credentials.</p><hr><h2 id=how-does-single-sign-on-sso-protocol-work>How Does Single Sign-On (SSO) protocol Work?</h2><p>There are two commonly used SSO protocols namely SAML and OAuth2.</p><h3 id=oauth2>OAuth2</h3><h4 id=role>Role</h4><p>OAuth defines four roles:</p><ol><li>resource owner</li></ol><blockquote><p>An entity capable of granting access to a protected resource.
When the resource owner is a person, it is referred to as an
end-user.</p></blockquote><ol start=2><li>resource server</li></ol><blockquote><p>The server hosting the protected resources, capable of accepting
and responding to protected resource requests using access tokens.</p></blockquote><ol start=3><li>client</li></ol><blockquote><p>An application making protected resource requests on behalf of the
resource owner and with its authorization. The term &ldquo;client&rdquo; does
not imply any particular implementation characteristics (e.g.,
whether the application executes on a server, a desktop, or other
devices).</p></blockquote><ol start=4><li>authorization server</li></ol><blockquote><p>The server issuing access tokens to the client after successfully
authenticating the resource owner and obtaining authorization.</p></blockquote><h4 id=protocol-flow>Protocol Flow</h4><p>Please refer to this link for the OAuth 2.0 authorization framework details: <a href=https://datatracker.ietf.org/doc/html/rfc6749#section-4.1>RFC 6749</a></p><p>The main process as below:</p><p><img src=oauth2flow.png alt="Oauth2 Flow">
The abstract OAuth 2.0 flow illustrated in above figure describes the interaction between the four roles and includes the following steps:</p><p><strong>(A)</strong> - The client requests authorization from the resource owner. The authorization request can be made directly to the resource owner(as shown), or preferably indirectly via the authorization
server as an intermediary.</p><p><strong>(B)</strong> - The client receives an authorization grant, which is a credential representing the resource owner&rsquo;s authorization, expressed using one of four grant types defined in this specification or using an extension grant type. The authorization grant type depends on the method used by the client to request authorization and the types supported by the authorization server.</p><p><strong>(C)</strong> - The client requests an access token by authenticating with the authorization server and presenting the authorization grant.</p><p><strong>(D)</strong> - The authorization server authenticates the client and validates the authorization grant, and if valid, issues an access token.</p><p><strong>(E)</strong> - The client requests the protected resource from the resource server and authenticates by presenting the access token.</p><p><strong>(F)</strong> - The resource server validates the access token, and if valid, serves the request.</p><h4 id=obtaining-authorization>Obtaining Authorization</h4><p>To request an access token, the client obtains authorization from the resource owner. The authorization is expressed in the form of an authorization grant, which the client uses to request the access token. OAuth defines four grant types:</p><ol><li><em><strong>authorization code</strong></em></li><li><em><strong>implicit</strong></em></li><li><em><strong>resource owner password credentials</strong></em></li><li><em><strong>client credentials</strong></em>.
It also provides an extension mechanism for defining additional grant types.</li></ol><h4 id=authorization-code-grant-flow>Authorization Code Grant Flow</h4><blockquote><p>The authorization code grant type is used to obtain both access
tokens and refresh tokens and is optimized for confidential clients.
Since this is a redirection-based flow, the client must be capable of
interacting with the resource owner&rsquo;s user-agent (typically a web
browser) and capable of receiving incoming requests (via redirection)
from the authorization server.</p></blockquote><p><img src=oauth2authcode.png alt="Authorization Code Grant Flow">
The flow illustrated in Figure 3 includes the following steps:</p><p><strong>(A)</strong> - The client initiates the flow by directing the resource owner&rsquo;s user-agent to the authorization endpoint. The client includes its client identifier, requested scope, local state, and a redirection URI to which the authorization server will send the user-agent back once access is granted (or denied).</p><p><strong>(B)</strong> - The authorization server authenticates the resource owner (via the user-agent) and establishes whether the resource owner grants or denies the client&rsquo;s access request.</p><p><strong>(C)</strong> - Assuming the resource owner grants access, the authorization server redirects the user-agent back to the client using the redirection URI provided earlier (in the request or during client registration). The redirection URI includes an authorization code and any local state provided by the client earlier.</p><p><strong>(D)</strong> - The client requests an access token from the authorization server&rsquo;s token endpoint by including the authorization code received in the previous step. When making the request, the client authenticates with the authorization server. The client includes the redirection URI used to obtain the authorization code for verification.</p><p><strong>(E)</strong> - The authorization server authenticates the client, validates the authorization code, and ensures that the redirection URI received matches the URI used to redirect the client in step (C). If valid, the authorization server responds back with an access token and, optionally, a refresh token.</p><h3 id=saml-20>SAML 2.0</h3><p>The SAML 2.0(Security Assertion Markup Language) Login feature provides an application with the capability to act as a SAML 2.0 Relying Party, having users log in to the application by using their existing account at a SAML 2.0 Asserting Party (Okta, ADFS, etc).</p><h4 id=role-1>Role</h4><ol><li>Principal</li><li>Service Provider(SP) - web service(like EDL)</li><li>Identity Provider(IdP) - Microsoft, AWS &mldr;</li></ol><h4 id=main-process>Main Process</h4><p>The main process as below:
<img src=samlflow.png alt=SAML2-flow></p><ol><li>First, a user makes an unauthenticated request to the resource <code>/private</code> for which it is not authorized.</li><li>Spring Security’s <a href=https://docs.spring.io/spring-security/reference/5.6.0-RC1/servlet/authorization/authorize-requests.html#servlet-authorization-filtersecurityinterceptor><code>FilterSecurityInterceptor</code></a> indicates that the unauthenticated request is <em>Denied</em> by throwing an <code>AccessDeniedException</code>.</li><li>Since the user lacks authorization, the <a href=https://docs.spring.io/spring-security/reference/5.6.0-RC1/servlet/architecture.html#servlet-exceptiontranslationfilter><code>ExceptionTranslationFilter</code></a> initiates <em>Start Authentication</em>. The configured <a href=https://docs.spring.io/spring-security/reference/5.6.0-RC1/servlet/authentication/architecture.html#servlet-authentication-authenticationentrypoint><code>AuthenticationEntryPoint</code></a> is an instance of <a href=https://docs.spring.io/spring-security/site/docs/5.6.0-RC1/api/org/springframework/security/web/authentication/LoginUrlAuthenticationEntryPoint.html><code>LoginUrlAuthenticationEntryPoint</code></a> which redirects to <a href=https://docs.spring.io/spring-security/reference/5.6.0-RC1/servlet/saml2/index.html#servlet-saml2login-sp-initiated-factory>the <code>&lt;saml2:AuthnRequest></code> generating endpoint</a>, <code>Saml2WebSsoAuthenticationRequestFilter</code>. Or, if you’ve <a href=https://docs.spring.io/spring-security/reference/5.6.0-RC1/servlet/saml2/index.html#servlet-saml2login-relyingpartyregistrationrepository>configured more than one asserting party</a>, it will first redirect to a picker page.</li><li>Next, the <code>Saml2WebSsoAuthenticationRequestFilter</code> creates, signs, serializes, and encodes a <code>&lt;saml2:AuthnRequest></code> using its configured <a href=https://docs.spring.io/spring-security/reference/5.6.0-RC1/servlet/saml2/index.html#servlet-saml2login-sp-initiated-factory><code>Saml2AuthenticationRequestFactory</code></a>.</li><li>Then, the browser takes this <code>&lt;saml2:AuthnRequest></code> and presents it to the asserting party. The asserting party attempts to authentication the user. If successful, it will return a <code>&lt;saml2:Response></code> back to the browser.</li><li>The browser then POSTs the <code>&lt;saml2:Response></code> to the assertion consumer service endpoint.</li></ol><hr><h2 id=usage-in-javaspring-security>Usage in Java(Spring Security)</h2><p>Please refer to this link for details: <a href=https://docs.spring.io/spring-security/reference/servlet/oauth2/login/core.html>Spring Security</a></p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://blog.singasoong.top/tags/%E7%AC%94%E8%AE%B0/>笔记</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>929 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2023-09-20 07:58</p></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=https://blog.singasoong.top/posts/ssl-%E4%B9%8B%E7%94%B3%E8%AF%B7%E8%AF%81%E4%B9%A6/><span class=button__icon>←</span>
<span class=button__text>SSL证书之acme</span></a></span>
<span class="button next"><a href=https://blog.singasoong.top/posts/keytool%E5%91%BD%E4%BB%A4/><span class=button__text>Keytool 命令</span>
<span class=button__icon>→</span></a></span></div></div><div id=gitalk-container></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script>
<script>const gitalk=new Gitalk({clientID:"124ff39b628505f4d977",clientSecret:"d199d6467a5da21b8b15f71edc7d02c7cc38e2f1",repo:"blog-comment",owner:"hesoong",admin:["hesoong"],id:location.pathname,distractionFreeMode:!1});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("gitalk-container").innerHTML="Gitalk comments not available by default when the website is previewed locally.";return}gitalk.render("gitalk-container")})()</script></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>Copyright &copy; 2025</span>
<span><a href=https://blog.singasoong.top/>Song</a></span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Theme made with <a href=https://atlialp.com/>rhazdon</a></span></div></div></footer></div><script type=text/javascript src=/bundle.min.205d491810c28f95aa953fae884e1c27abe13fdf93ec63b882d0036b248d4a6282eb2d134e4e7225c6ad6e86db87b08488a361ca4a7383d01fcff43f3d57b9c3.js integrity="sha512-IF1JGBDCj5WqlT+uiE4cJ6vhP9+T7GO4gtADaySNSmKC6y0TTk5yJcatbobbh7CEiKNhykpzg9Afz/Q/PVe5ww=="></script>
<script src=/js/anchorforid.js></script>
<script src=/js/main.js></script></body></html>